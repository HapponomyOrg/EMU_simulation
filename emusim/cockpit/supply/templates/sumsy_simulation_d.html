{% extends "happonomysim.html" %}

{% block content %}
<div class="row d-flex justify-content-center">
    <h2>SuMSy Supply Simulation</h2>
</div>
{% if not render_graphs %}
<form action="" method="post">
    {{ parameter_form.csrf_token }}
    <div class="card  d-inline-flex  mb-2">
        <h5 class="card-header info-color white-text text-center py-4">
            <strong>Simulation parameters</strong>
        </h5>
        <div class="card-body px-lg-5 pt-0">

            <table class="outertable">
                <tr>
                    <td class="tabledata">
                        <table>
                            <tr>
                                <td>{{ parameter_form.num_iterations.label }}</td>
                                <td>{{ parameter_form.num_iterations }}</td>
                            </tr>
                            <tr>
                                <td colspan="3" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.population.label }}</td>
                                <td>{{ parameter_form.population }}</td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.population_growth.label }}</td>
                                <td>{{ parameter_form.population_growth }}</td>
                                <td>%</td>
                            </tr>
                            <tr>
                                <td colspan="3" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.start_at_saturation.label }}</td>
                                <td>{{ parameter_form.start_at_saturation }}</td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.money_mass.label }}</td>
                                <td>{{ parameter_form.money_mass }}</td>
                            </tr>
                            <tr>
                                <td colspan="3" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.income.label }}</td>
                                <td>{{ parameter_form.income }}</td>
                            </tr>
                            <tr>
                                <td colspan="3" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.inflation.label }}</td>
                                <td>{{ parameter_form.inflation }}</td>
                                <td>%</td>
                            </tr>
                            <tr>
                                <td colspan="3" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.num_dem_tiers.label }}</td>
                                <td>{{ parameter_form.num_dem_tiers }}</td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.dem_tier_1.label }}</td>
                                <td>{{ parameter_form.dem_tier_1 }}</td>
                                <td>{{ parameter_form.dem_rate_1 }}</td>
                                <td>%</td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.dem_tier_2.label }}</td>
                                <td>{{ parameter_form.dem_tier_2 }}</td>
                                <td>{{ parameter_form.dem_rate_2 }}</td>
                                <td>%</td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.dem_tier_3.label }}</td>
                                <td>{{ parameter_form.dem_tier_3 }}</td>
                                <td>{{ parameter_form.dem_rate_3 }}</td>
                                <td>%</td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.dem_tier_4.label }}</td>
                                <td>{{ parameter_form.dem_tier_4 }}</td>
                                <td>{{ parameter_form.dem_rate_4 }}</td>
                                <td>%</td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.dem_tier_5.label }}</td>
                                <td>{{ parameter_form.dem_tier_5 }}</td>
                                <td>{{ parameter_form.dem_rate_5 }}</td>
                                <td>%</td>
                            </tr>
                            <tr>
                                <td colspan="3" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.common_good_spending.label }}</td>
                                <td>{{ parameter_form.common_good_spending }}</td>
                            </tr>
                            <tr>
                                <td>{{ parameter_form.common_good_budget.label }}</td>
                                <td>{{ parameter_form.common_good_budget }}</td>
                            </tr>
                        </table>
                    </td>

                </tr>
            </table>
            <hr>


        </div>
    </div>
    <div class="card  d-inline-flex  mb-2">
        <h5 class="card-header info-color white-text text-center py-4">
            <strong>Output specification</strong>
        </h5>
        <div class="card-body px-lg-5 pt-0">

            <table class="outertable">
                <tr>
                    <td class="tabledata">

                        <table>

                            <tr>
                                <td>{{ data_selection_form.population.label }}</td>
                                <td>{{ data_selection_form.population }}</td>
                            </tr>
                            <tr>
                                <td colspan="2" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.deflate.label }}</td>
                                <td>{{ data_selection_form.deflate }}</td>
                            </tr>
                            <tr>
                                <td colspan="2" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.money_mass.label }}</td>
                                <td>{{ data_selection_form.money_mass }}</td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.per_capita_money_mass.label }}</td>
                                <td>{{ data_selection_form.per_capita_money_mass }}</td>
                            </tr>
                            <tr>
                                <td colspan="2" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.demurrage_tiers.label }}</td>
                                <td>{{ data_selection_form.demurrage_tiers }}</td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.demurrage.label }}</td>
                                <td>{{ data_selection_form.demurrage }}</td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.per_capita_demurrage.label }}</td>
                                <td>{{ data_selection_form.per_capita_demurrage }}</td>
                            </tr>
                            <tr>
                                <td colspan="2" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.money_cycle.label }}</td>
                                <td>{{ data_selection_form.money_cycle }}</td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.per_capita_money_cycle.label }}</td>
                                <td>{{ data_selection_form.per_capita_money_cycle }}</td>
                            </tr>
                            <tr>
                                <td colspan="2" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.common_good.label }}</td>
                                <td>{{ data_selection_form.common_good }}</td>
                            </tr>
                            <tr>
                                <td colspan="2" class="divider">
                                    <hr/>
                                </td>
                            </tr>
                            <tr>
                                <td>{{ data_selection_form.percentages.label }}</td>
                                <td>{{ data_selection_form.percentages }}</td>
                            </tr>
                        </table>
                    </td>

                </tr>
            </table>
            <hr>
            <div class="input submit">
        <input class=" btn btn-primary btn-sm button" type="submit" value="Run">
    </div>

        </div>
    </div>



</form>
{% endif %}
{% if render_graphs %}
<div class="row"><div class="col">Equilibruim balance for this simulation: {{ equilibrium_balance }} <a class="btn btn-primary btn-sm float-right" type="button"
       href="{{ url_for('sumsy_supply_d.sumsy_supply_simulation_d') }}">New simulation</a></div></div>
{% if crashed %}
<div class="row"><div class="col">Crashed: ran for {{ cycles_executed }} cycles</div></div>
{% endif %}
<div class="container">
    <div class="row">


        {% for graphs in graph_data %}
        {% for graph in graphs %}
        <div class="col-md-6">
            <img src={{graph|safe}} class="img-fluid p-2" style="width:100%">
        </div>

        {% endfor %}
        {% endfor %}


    </div>

</div>
{% endif %}
{% endblock %}